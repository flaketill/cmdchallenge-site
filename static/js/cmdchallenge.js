var GLOBAL_VERSION=1,CMD_URL="https://api.cmdchallenge.com",TAB_COMPLETION=["war_and_peace.txt","sum-me.txt","find","echo","awk","sed","perl","wc","grep","access.log","cat","sort","README","split-me.txt","file-with-tabs.txt","cut","faces.txt"],STORAGE_CORRECT="correct_answers",BADGE_MSGS={b0:"Are you up for the command line challenge? Solve the tasks printed below in a single line of bash.",b1:"You are off to a great start, keep on going!",b2:"You have a shrug-man, this means you are doing well!",b3:"On your way to becoming a super-duper commandline hacker.",b4:"Wow, not many have gotten this far... don't stop!",b5:"I impressed at how far you have gotten... keep at it!",b6:"You are officially a command line master, great job!"},BADGE_CUTOFFS={100:"b6",80:"b5",50:"b4",25:"b3",10:"b2"};jQuery(function(e){var t,n,o,c,r,a,l,i,u,s,d,f,g,m,h,p,E,y,v,b={};f=function(e){var t;try{t=JSON.parse(localStorage.getItem(e))}catch(e){t=[]}return null===t&&(t=[]),t},g=function(e,t,n){var o,c;o=_.uniq(f(t)),c=JSON.stringify(o.concat([e])),localStorage.setItem(t,c),"function"==typeof n&&n()},h=function(e,t,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},v=function(){var t=_.uniq(f(STORAGE_CORRECT)),n=t.length===c;n?(document.getElementById("header").style.display="none",document.getElementById("breakout-box").style.display="block",e.getScript("js/figlet-breakout.min.js",function(){window.Breakout()})):(document.getElementById("header").style.display="block",document.getElementById("breakout-box").style.display="none")},m=function(e){var t=f(STORAGE_CORRECT);e.forEach(function(e){if(t.indexOf(e.slug)!==-1){var n=document.getElementById(e.slug);s(n,"checked")}})},i=function(e,t,n){return n||(n=""),"[["+n+";"+t+";black]"+e+"]"},u=function(e,t){t.forEach(function(t){var n=document.getElementById(t.slug),o=n.parentNode;n.id===e?s(o,"active_challenge"):d(o,"active_challenge")})},s=function(e,t){e.classList?e.classList.add(t):e.class_name+=" "+t},d=function(e,t){e.classList?e.classList.remove(t):e.class_name=e.class_name.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},l=function(e,t,n){var o=document.getElementById("challenges"),c={};e.forEach(function(n){var r=document.createElement("a");r.id=n.slug,r.href="#/"+n.slug,r.title=n.slug;var a=document.createTextNode(n.slug+"/");r.appendChild(a);var l=document.createElement("li");l.appendChild(r),h("click",r,function(e){e.preventDefault(),e.stopPropagation(),routie("/"+n.slug)}),o.appendChild(l),c["/"+n.slug]=function(){u(n.slug,e),b=n,t.echo(i("# ","teal")+i("You have a new challenge!","white")),b.description.split(/\n/).forEach(function(e){t.echo(i("# "+e,"teal"))})}}),routie(c),"function"==typeof n&&n()},y=function(){var e=document.getElementById("badge_text");e.innerHTML=E()},E=function(){var e,t,n,o,r=f(STORAGE_CORRECT).length,a=Object.keys(BADGE_CUTOFFS).map(function(e){return Number(e)}).sort(function(e,t){return e-t}),l=Math.floor(r/c*100);if(0===r)return BADGE_MSGS.b0;for(r>=1&&(t=BADGE_MSGS.b1,n=document.getElementById("b1"),s(n,"completed")),e=0;e<a.length;e++)o=BADGE_CUTOFFS[a[e].toString()],n=document.getElementById(o),l>=a[e]?(t=BADGE_MSGS[o],s(n,"completed")):d(n,"completed");return t},r=function(t){e.ajax({dataType:"json",url:"/challenges/challenges.json",success:function(e){"function"==typeof t&&t(e)},error:function(){n="‚ò†Ô∏è",alert("error")}})},a=function(t,n){var o;o={cmd:t,challenge_slug:b.slug,version:b.version,g_version:GLOBAL_VERSION},e.ajax({type:"GET",url:CMD_URL,async:!0,data:o,success:function(e){"function"==typeof n&&n(e)},error:function(e){if("function"==typeof n){var t=e.responseText||"Unknown Error :(";n({output:t,correct:!1,return_code:"‚ò†Ô∏è"})}}})},p=function(e,t){var n,o=t.map(function(e){return e.slug}).indexOf(e),c=f(STORAGE_CORRECT);for(n=o+1;n<t.length;n++)if(c.indexOf(t[n].slug)===-1)return t[n];return t[0]},o=document.getElementById("reset"),n=i("0","green"),h("click",o,function(e){e.preventDefault(),localStorage.clear(),location.reload()}),r(function(o){var r=null;b=null,c=o.length,y(),e("#term_challenge").terminal(function(e,t){""!==e?(t.pause(),a(e,function(e){n=0===e.return_code?i(e.return_code,"green"):i(e.return_code,"red"),t.echo(e.output),e.correct?(t.echo(i("# üëç üëç üëç  Correct!","green")),g(e.challenge_slug,STORAGE_CORRECT,function(){var t=document.getElementById(e.challenge_slug);s(t,"checked"),r=p(e.challenge_slug,o),y(),v(),r&&(b=r,routie("/"+b.slug))})):e.test_errors&&t.echo(i(e.test_errors.join("\n"),"gray")),t.resume()})):t.echo("")},{greetings:"",name:"js_demo",height:300,convertLinks:!0,prompt:function(e){e("bash("+n+")> ")},completion:TAB_COMPLETION,onClear:function(){b&&(n=i("0","green"),b.description.split(/\n/).forEach(function(e){t.echo(i("# "+e,"teal"))}))}}),t=e.terminal.active(),l(o,t,function(){b||(b=o[0],b.description.split(/\n/).forEach(function(e){t.echo(i("# "+e,"teal"))})),m(o),v()})})});
